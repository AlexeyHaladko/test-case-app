const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/page-CNMG91p_.js","assets/vendor-xQZBn1hS.js","assets/mui-6TiAU9Pq.js","assets/rolldown-runtime-DGruFWvd.js","assets/tanstack-a0KEQ1Fg.js","assets/generated.schemas-CmnXDYcV.js","assets/page-D9E0Slas.js","assets/form-field-C0DSM4KJ.js","assets/page-CT86DpIr.js"])))=>i.map(i=>d[i]);
import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{D as t,E as n,F as r,L as i,M as a,N as o,O as s,P as c,T as l,j as u,k as d,m as f,n as ee,p as te,s as p,t as m,w as h,x as g}from"./mui-6TiAU9Pq.js";import{_,d as v,f as y,g as b,h as x,l as S,m as ne,p as re,u as C,v as ie}from"./vendor-xQZBn1hS.js";import{a as ae,i as oe,n as se,o as ce,r as le}from"./tanstack-a0KEQ1Fg.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var w=ie(),T=i();const E=`auth_token`,D=()=>localStorage.getItem(E),O=e=>localStorage.setItem(E,e),k=()=>localStorage.removeItem(E);function A(){if(!D())throw x(Q.LOGIN)}var j=A,M=r();function N({error:e}){return(0,M.jsx)(M.Fragment,{children:e?.message||`Smth went wrong`})}var P=N;const F=(0,T.createContext)(null),I=()=>{let e=(0,T.useContext)(F);if(!e)throw Error(`useAuth must be used within an AuthProvider`);return e};function L(){let{user:e,logout:n}=I();return(0,M.jsxs)(te,{direction:`row`,spacing:2,alignItems:`center`,children:[e&&(0,M.jsx)(t,{variant:`body1`,children:e.username}),(0,M.jsx)(h,{variant:`outlined`,size:`small`,onClick:n,children:`Logout`})]})}var R=L;const z=(0,T.createContext)({mode:`light`,toggleColorMode:()=>{}}),B=()=>(0,T.useContext)(z);function V(){let e=o(),{toggleColorMode:t}=B();return(0,M.jsx)(d,{sx:{ml:1},onClick:t,color:`inherit`,children:e.palette.mode===`dark`?(0,M.jsx)(m,{}):(0,M.jsx)(ee,{})})}var H=a(v)(({theme:e})=>({color:`inherit`,textDecoration:`none`,padding:e.spacing(1,2),borderRadius:e.shape.borderRadius,"&.active":{backgroundColor:e.palette.action.selected,fontWeight:`bold`},"&:hover":{backgroundColor:e.palette.action.hover}}));function U(){return(0,M.jsx)(n,{position:`static`,color:`default`,elevation:1,children:(0,M.jsxs)(p,{children:[(0,M.jsxs)(l,{sx:{flexGrow:1,display:`flex`,gap:2},children:[(0,M.jsx)(H,{to:Q.DASHBOARD,children:`DASHBOARD`}),(0,M.jsx)(H,{to:Q.FORM,children:`FORM`})]}),(0,M.jsxs)(l,{sx:{display:`flex`,alignItems:`center`,gap:2},children:[(0,M.jsx)(R,{}),(0,M.jsx)(V,{})]})]})})}var W=U;function ue(){return(0,M.jsxs)(C,{FallbackComponent:P,children:[(0,M.jsx)(W,{}),(0,M.jsx)(y,{})]})}var de=ue;function fe(){return(0,M.jsx)(`div`,{className:`auth-container`,style:{display:`flex`,justifyContent:`center`,alignItems:`center`,minHeight:`100vh`},children:(0,M.jsx)(C,{FallbackComponent:P,children:(0,M.jsx)(y,{})})})}const G=S.create({baseURL:`https://backendcase.infodecs.dev/`,headers:{Accept:`application/json, text/plain, */*`}});G.interceptors.request.use(e=>{let t=D();return t&&(e.headers.Authorization=`Bearer ${t}`),e}),G.interceptors.response.use(e=>e,e=>{throw S.isAxiosError(e)&&e.response?.status===401?(localStorage.removeItem(E),e.response.data.error||`Smth With Wrong`):S.isAxiosError(e)?e?.response?.data?.error||`Smth With Wrong`:{message:`Smth Went Wrong `}});const K=async(e,t)=>(await G.get(e,t)).data,q=async(e,t)=>(await G.post(e,t)).data,J={userInfo:`user_info_key`,getTableData:`table_data_key`},Y={login:`/api/auth/login/`,getUserInfo:`/api/auth/user/`,getTableData:`/api/table/data/`,createCrop:`/api/form/submit/`};function pe(){let e=D();return le({queryKey:[J.userInfo],queryFn:()=>K(Y.getUserInfo),staleTime:1/0,retry:!1,enabled:!!e})}var me=pe,he=async e=>await q(Y.login,e);function ge(e={}){return se({mutationFn:he,...e})}var _e=ge,X=(0,T.createContext)(void 0);const ve=({children:e})=>{let[t,n]=(0,T.useState)(!1),[r,i]=(0,T.useState)(``),[a,o]=(0,T.useState)(`success`),c=(0,T.useCallback)((e,t=`success`)=>{i(e),o(t),n(!0)},[]),l=(e,t)=>{t!==`clickaway`&&n(!1)};return(0,M.jsxs)(X.Provider,{value:{showSnackbar:c},children:[e,(0,M.jsx)(f,{open:t,autoHideDuration:6e3,onClose:l,anchorOrigin:{vertical:`top`,horizontal:`right`},children:(0,M.jsx)(s,{onClose:l,severity:a,sx:{width:`100%`},children:r})})]})},Z=()=>{let e=(0,T.useContext)(X);if(!e)throw Error(`useSnackbar must be used within a SnackbarProvider`);return e},ye=({children:e})=>{let t=ae(),{showSnackbar:n}=Z(),r=b(),i=D(),{data:a,isLoading:o}=me(),{mutate:s,isPending:c}=_e({onSuccess:e=>{t.setQueryData([J.userInfo],e.user),O(e.access)},onError:e=>{n(e,`error`)}}),l={login:s,user:a,logout:()=>{k(),t.setQueryData([J.userInfo],null),r(Q.LOGIN)},isAuthenticated:!!a&&!!i,userDataLoading:o,loginProcessing:c};return(0,M.jsx)(F.Provider,{value:l,children:e})},be=new ce,xe=e=>c({palette:{mode:e,...e===`light`?{primary:{light:`#757ce8`,main:`#3f50b5`,dark:`#002884`,contrastText:`#fff`},secondary:{light:`#ff7961`,main:`#f44336`,dark:`#ba000d`,contrastText:`#000`}}:{primary:{main:`#90caf9`},secondary:{main:`#f48fb1`}}},components:{MuiPaper:{styleOverrides:{root:{boxShadow:e===`light`?`0px 2px 8px rgba(103, 58, 183, 0.3)`:`0px 2px 8px rgba(0, 0, 0, 0.5)`}}}}});function Se(){let[e,t]=(0,T.useState)(`light`),n=(0,T.useMemo)(()=>({mode:e,toggleColorMode:()=>{t(e=>e===`light`?`dark`:`light`)}}),[e]),r=(0,T.useMemo)(()=>xe(e),[e]);return(0,M.jsx)(oe,{client:be,children:(0,M.jsx)(z.Provider,{value:n,children:(0,M.jsxs)(u,{theme:r,children:[(0,M.jsx)(g,{}),(0,M.jsx)(ve,{children:(0,M.jsx)(ye,{children:(0,M.jsx)(y,{})})})]})})})}var Ce=Se;const Q={LOGIN:`login`,DASHBOARD:`dashboard`,FORM:`form`};var $=(0,T.lazy)(()=>_(()=>import(`./page-CNMG91p_.js`),__vite__mapDeps([0,1,2,3,4,5])).then(e=>({default:e.TablePage}))),we=(0,T.lazy)(()=>_(()=>import(`./page-D9E0Slas.js`),__vite__mapDeps([6,1,2,3,4,5,7])).then(e=>({default:e.FormPage}))),Te=(0,T.lazy)(()=>_(()=>import(`./page-CT86DpIr.js`),__vite__mapDeps([8,1,2,3,4,7])).then(e=>({default:e.LoginPage}))),Ee=ne([{path:`/test-case-app`,Component:Ce,children:[{Component:fe,children:[{path:Q.LOGIN,Component:Te}]},{Component:de,middleware:[j],children:[{index:!0,loader:()=>x(Q.DASHBOARD)},{path:Q.DASHBOARD,Component:$},{path:Q.FORM,Component:we}]}]}]);(0,w.createRoot)(document.getElementById(`root`)).render((0,M.jsx)(T.StrictMode,{children:(0,M.jsx)(re,{router:Ee})}));export{K as a,D as c,J as i,Z as n,q as o,Y as r,I as s,Q as t};