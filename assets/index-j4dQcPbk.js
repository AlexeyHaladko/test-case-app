const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/page-DG8UUW8V.js","assets/vendor-xQZBn1hS.js","assets/mui-6TiAU9Pq.js","assets/rolldown-runtime-DGruFWvd.js","assets/tanstack-a0KEQ1Fg.js","assets/generated.schemas-CmnXDYcV.js","assets/page-DC4xhcZS.js","assets/form-field-C0DSM4KJ.js","assets/page-D2lkdVMY.js"])))=>i.map(i=>d[i]);
import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{D as t,E as n,F as r,L as i,M as a,N as o,O as s,P as c,T as l,j as ee,k as te,m as u,n as d,p as f,s as p,t as m,w as h,x as ne}from"./mui-6TiAU9Pq.js";import{_ as g,d as re,f as _,g as ie,h as v,l as y,m as b,p as x,u as S,v as C}from"./vendor-xQZBn1hS.js";import{a as ae,i as oe,n as se,o as ce,r as le}from"./tanstack-a0KEQ1Fg.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var w=C(),T=i();const E=`auth_token`,D=()=>localStorage.getItem(E),O=e=>localStorage.setItem(E,e),k=()=>localStorage.removeItem(E);function A(){if(!D())throw v($.LOGIN)}var j=A,M=r();function N({error:e}){return console.log(`ErrorBoundaryFallback`,e),(0,M.jsx)(M.Fragment,{children:e?.message||`Smth went wrong`})}var P=N;const F=(0,T.createContext)(null),I=()=>{let e=(0,T.useContext)(F);if(!e)throw Error(`useAuth must be used within an AuthProvider`);return e};function L(){let{user:e,logout:n}=I();return(0,M.jsxs)(f,{direction:`row`,spacing:2,alignItems:`center`,children:[e&&(0,M.jsx)(t,{variant:`body1`,children:e.username}),(0,M.jsx)(h,{variant:`outlined`,size:`small`,onClick:n,children:`Logout`})]})}var R=L;const z=(0,T.createContext)({mode:`light`,toggleColorMode:()=>{}}),B=()=>(0,T.useContext)(z);function V(){let e=o(),{toggleColorMode:t}=B();return(0,M.jsx)(te,{sx:{ml:1},onClick:t,color:`inherit`,children:e.palette.mode===`dark`?(0,M.jsx)(m,{}):(0,M.jsx)(d,{})})}var H=a(re)(({theme:e})=>({color:`inherit`,textDecoration:`none`,padding:e.spacing(1,2),borderRadius:e.shape.borderRadius,"&.active":{backgroundColor:e.palette.action.selected,fontWeight:`bold`},"&:hover":{backgroundColor:e.palette.action.hover}}));function U(){return(0,M.jsx)(n,{position:`static`,color:`default`,elevation:1,children:(0,M.jsxs)(p,{children:[(0,M.jsxs)(l,{sx:{flexGrow:1,display:`flex`,gap:2},children:[(0,M.jsx)(H,{to:$.DASHBOARD,children:`DASHBOARD`}),(0,M.jsx)(H,{to:$.FORM,children:`FORM`})]}),(0,M.jsxs)(l,{sx:{display:`flex`,alignItems:`center`,gap:2},children:[(0,M.jsx)(R,{}),(0,M.jsx)(V,{})]})]})})}var W=U;function ue(){return(0,M.jsxs)(S,{FallbackComponent:P,children:[(0,M.jsx)(W,{}),(0,M.jsx)(_,{})]})}var de=ue;function fe(){return(0,M.jsx)(`div`,{className:`auth-container`,style:{display:`flex`,justifyContent:`center`,alignItems:`center`,minHeight:`100vh`},children:(0,M.jsx)(S,{FallbackComponent:P,children:(0,M.jsx)(_,{})})})}const G=y.create({baseURL:`https://backendcase.infodecs.dev/`,headers:{Accept:`application/json, text/plain, */*`}});G.interceptors.request.use(e=>{let t=D();return t&&(e.headers.Authorization=`Bearer ${t}`),e}),G.interceptors.response.use(e=>e,e=>{throw y.isAxiosError(e)&&e.response?.status===401?(localStorage.removeItem(E),e.response.data.error||`Smth With Wrong`):y.isAxiosError(e)?e?.response?.data?.error||`Smth With Wrong`:{message:`Smth Went Wrong `}});const K=async(e,t)=>(await G.get(e,t)).data,q=async(e,t)=>(await G.post(e,t)).data,J={userInfo:`user_info_key`,getTableData:`table_data_key`},Y={login:`/api/auth/login/`,getUserInfo:`/api/auth/user/`,getTableData:`/api/table/data/`,createCrop:`/api/form/submit/`};function pe(){let e=D();return le({queryKey:[J.userInfo],queryFn:()=>K(Y.getUserInfo),staleTime:1/0,retry:!1,enabled:!!e})}var me=pe,he=async e=>await q(Y.login,e);function ge(e={}){return se({mutationFn:he,...e})}var _e=ge,X=(0,T.createContext)(void 0);const ve=({children:e})=>{let[t,n]=(0,T.useState)(!1),[r,i]=(0,T.useState)(``),[a,o]=(0,T.useState)(`success`),c=(0,T.useCallback)((e,t=`success`)=>{i(e),o(t),n(!0)},[]),l=(e,t)=>{t!==`clickaway`&&n(!1)};return(0,M.jsxs)(X.Provider,{value:{showSnackbar:c},children:[e,(0,M.jsx)(u,{open:t,autoHideDuration:6e3,onClose:l,anchorOrigin:{vertical:`top`,horizontal:`right`},children:(0,M.jsx)(s,{onClose:l,severity:a,sx:{width:`100%`},children:r})})]})},Z=()=>{let e=(0,T.useContext)(X);if(!e)throw Error(`useSnackbar must be used within a SnackbarProvider`);return e},ye=({children:e})=>{let t=ae(),{showSnackbar:n}=Z(),r=ie(),i=D(),{data:a,isLoading:o}=me(),{mutate:s,isPending:c}=_e({onSuccess:e=>{t.setQueryData([J.userInfo],e.user),O(e.access)},onError:e=>{n(e,`error`)}}),l={login:s,user:a,logout:()=>{k(),t.setQueryData([J.userInfo],null),r($.LOGIN)},isAuthenticated:!!a&&!!i,userDataLoading:o,loginProcessing:c};return(0,M.jsx)(F.Provider,{value:l,children:e})},Q=new ce,be=e=>c({palette:{mode:e,...e===`light`?{primary:{light:`#757ce8`,main:`#3f50b5`,dark:`#002884`,contrastText:`#fff`},secondary:{light:`#ff7961`,main:`#f44336`,dark:`#ba000d`,contrastText:`#000`}}:{primary:{main:`#90caf9`},secondary:{main:`#f48fb1`}}},components:{MuiPaper:{styleOverrides:{root:{boxShadow:e===`light`?`0px 2px 8px rgba(103, 58, 183, 0.3)`:`0px 2px 8px rgba(0, 0, 0, 0.5)`}}}}});function xe(){let[e,t]=(0,T.useState)(`light`),n=(0,T.useMemo)(()=>({mode:e,toggleColorMode:()=>{t(e=>e===`light`?`dark`:`light`)}}),[e]),r=(0,T.useMemo)(()=>be(e),[e]);return(0,M.jsx)(oe,{client:Q,children:(0,M.jsx)(z.Provider,{value:n,children:(0,M.jsx)(ee,{theme:r,children:(0,M.jsxs)(S,{FallbackComponent:P,children:[(0,M.jsx)(ne,{}),(0,M.jsx)(ve,{children:(0,M.jsx)(ye,{children:(0,M.jsx)(_,{})})})]})})})})}var Se=xe,Ce=()=>(0,M.jsxs)(`div`,{children:[(0,M.jsx)(`h1`,{children:`404 Error`}),(0,M.jsx)(`p`,{children:`Page Not Found`}),(0,M.jsx)(`p`,{children:`The page you are looking for does not exist.`})]});const $={LOGIN:`login`,DASHBOARD:`dashboard`,FORM:`form`};var we=(0,T.lazy)(()=>g(()=>import(`./page-DG8UUW8V.js`),__vite__mapDeps([0,1,2,3,4,5])).then(e=>({default:e.TablePage}))),Te=(0,T.lazy)(()=>g(()=>import(`./page-DC4xhcZS.js`),__vite__mapDeps([6,1,2,3,4,5,7])).then(e=>({default:e.FormPage}))),Ee=(0,T.lazy)(()=>g(()=>import(`./page-D2lkdVMY.js`),__vite__mapDeps([8,1,2,3,4,7])).then(e=>({default:e.LoginPage}))),De=b([{path:`/test-case-app`,Component:Se,children:[{Component:fe,children:[{path:$.LOGIN,Component:Ee}]},{Component:de,middleware:[j],children:[{index:!0,loader:()=>v($.DASHBOARD)},{path:$.DASHBOARD,Component:we},{path:$.FORM,Component:Te}]},{path:`*`,Component:Ce}]}]);(0,w.createRoot)(document.getElementById(`root`)).render((0,M.jsx)(T.StrictMode,{children:(0,M.jsx)(x,{router:De})}));export{K as a,D as c,J as i,Z as n,q as o,Y as r,I as s,$ as t};